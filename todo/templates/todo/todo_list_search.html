{% extends "todo/layout.html" %}
{%block title %}todo{% endblock %}
{%block content %}

<br>
<h2>할일 검색 결과 1122 : {{search_word}}</h2>
<table class="table table-bordered">
{% for p in object_list %}
    <tr>
        <td>{{p.author}}</td>
        <td>
            <a href="" id={{p.id}} class="title_for_list">
                {{p.title}}
            </a>
        </td>
        <td>{{p.now_diff}}</td>
    </tr>
{% endfor %}
</table>



<hr>
{% if is_paginated %}
    <!-- Pagination -->
    <ul class="pagination justify-content-center mb-4">
        {% if page_obj.has_next %}
        <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}">&larr; Older</a>
        </li>
        {% else %}
        <li class="page-item disabled">
                <a class="page-link" href="#">&larr; Older</a>
        </li>
        {% endif %}

        {% if page_obj.has_previous %}
        <li class="page-item">
            <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Newer &rarr;</a>
        </li>
        {% else %}
        <li class="page-item disabled">
            <a class="page-link" href="#">Newer &rarr;</a>
        </li>
        {% endif %}
    </ul>
{% endif %}

<hr>

<!-- Modal -->
<button type="button" id="myModal_button" class="btn btn-primary invisible" data-toggle="modal" data-target="#myModal">
    todo detail modal
</button>
<!-- The Modal -->
<div class="modal fade" id="myModal">

</div>


<script type="text/javascript">
    // modal 이벤트 : 상세 보기
    {% block extra_js %}
    $(".title_for_list").click(function(e){
        e.preventDefault();
        id = $(this).attr('id');
        alert("id : " +id)

        window.history.pushState("", "", '/todo/')

        $.get(id)
        .done((html) => {
            console.log("html : ", html);
            $('#myModal_button').hide();
            $("#myModal").html(html)
            $( "#myModal_button" ).trigger("click");
            // $( "#myModal_button3" ).trigger("click");
        })
        .fail(() => {
            console.log("fail");
        })
        .always(() => {
            console.log('always');
        })
    });
    {% endblock %}

</script>


{% endblock %}
