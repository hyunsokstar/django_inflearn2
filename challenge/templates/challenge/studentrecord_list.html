{% extends "layout.html" %}

{%block title %}Study Challenge{% endblock %}

{%block content4 %}

{%block extra_head %}
<script src="https://kit.fontawesome.com/1e74fee713.js"></script>

{% endblock %}


<br><br><br><br>

<h2>공동 study</h2>

<!-- {{request.user}} {{LecInfo.manager}} -->
{%if request.user.username == LecInfo.manager  %}
<a class="btn btn-outline-dark float-right" href="{% url "challenge:lecinfo_list_for_challenge" LecInfo.challenge.title %}">목록</a>
    <a class="btn btn-outline-dark float-right" href="{% url "challenge:LecInfoDeleteView" LecInfo.id %}">삭제</a>
    <a href="{% url "challenge:lec_info_update" LecInfo.id LecInfo.id %}" class="btn btn-outline-dark float-right">수정</a>

{% else %}
{% endif %}

<br><br>

<table class="table table-bordered">
  <tr>
      <td>소모임명</td>
      <td colspan="3">
          <input type="text" name="" value="{{LecInfo.lec_name}}" class="form-control"><br>
      </td>
  </tr>
  <tr>
      <td>담당자</td>
      <td>
          <input type="text" name="" value="{{LecInfo.manager}}" class="form-control">
      </td>
      <td>site</td>
      <td>
          <a href="{{LecInfo.lec_url }}">
              <i class="fas fa-home fa-2x"></i>
          </a>
      </td>
  </tr>
  <tr>
      <td>github</td>
      <td>
          <a href="{{LecInfo.git_url}}">
              <i class="fab fa-github fa-2x"></i>
          </a>
      </td>
      <td>강의 평점</td>
      <td>
          <input type="text" name="" value="{{recommnad_count}}">
          <a href="{% url "challenge:recommand_lecture" LecInfo.pk %}">
              <i class="far fa-plus-square fa-2x"></i>
          </a>
      </td>
  </tr>

</table>

<br><br><hr>


{% if messages %}
<div class="alert alert-success">
    {% for message in messages %}
     {{ message.message }}<strong>{{ message.tags }}</strong>
     {% endfor %}
</div>
{% endif %}

<a href="/challenge/record/new/{{LecInfo.id}}" class="btn btn-outline-warning float-right">입력(input)</a>
<br><br>
<table class="table table-bordered" id="todo_list">
    <tr>
        <td>check</td>
        <td>index</td>
        <td>author</td>
        <td>current_class</td>
        <td>github</td>
    </tr>

    {% if object_list.exists %}
        {% for p in object_list %}
            <tr>
                <td>
                    <input type="checkbox" id="{{p.pk}}" class="td_check">
                </td>
                <td>
                    {{ forloop.counter }}
                </td>
                <td>
                    {{p.author}}
                    <a href="#" class="badge badge-dark movetoshortcut" id={{request.user.id}} data-user_id={{p.author}} >skilnote</a>

                </td>
                <td>
                    {{p.current_class}}

                    {% if request.user == p.author %}
                        <a class="badge badge-pill badge-primary btn-sm" href="{% url "challenge:student_record_delete" p.id LecInfo.id %}">삭제</a>
                        <a class="badge badge-pill badge-primary btn-sm" href="{% url "challenge:student_record_update" p.id LecInfo.id %}">수정</a>
                    {% endif %}

                </td>
                <td>

                    <a class="go_to_next_channer_btn btn btn-outline-success" href={{p.github_url}}>
                    	<img src="/static/icon/git_icon.png" alt="">
                    </a>

                </td>
            </tr>
        {% endfor %}
    {% else %}
        <tr>
            <td colspan="7">
                <h4>아직 게시물이 없습니다.</h4>
            </td>
        </tr>
    {% endif %}
</table>

<!-- Modal -->
<div class="modal fade" id="myModal" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Modal Header2</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body">
        <p>Some text in the modal.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>

  </div>
</div>

{% endblock %}
<script type="text/javascript">
{% block extra_js %}

$(document).ready(function(){
    $('.movetoshortcut').click(function(e){
        e.preventDefault();

        const id = this.id
        const user_id = $(this).data("user_id")

        // alert("id : " + id)
        // alert("user_id : " +user_id)

        window.history.pushState("", "", '/wm/')

        $.ajax({
          type: "POST",
          url: 'update/shortcut_id_ajax/'+id,
          data: {
              'user_id':user_id,
              csrfmiddlewaretoken: '{{ csrf_token }}'
          },
            success: function(result) {
                // alert('update for user shortcut id is success ');
                console.log("result : ", result);
                // alert("result.message :     shorcut page로 이동")
                var url = "http://terecal-hyun.co.kr/wm/myshortcut/"+user_id+"/1"
                document.location.href = url
            }
        });
    })


    $("#insert_record_btn").click(function(){
        $("#myModal").modal();
    });

});

{% endblock %}
</script>
